[
    {
        "name": "Generic: Hard-coded SSL/TLS Protocol",
        "id": "DS440000",
        "description": "Generic: Hard-coded SSL/TLS Protocol",
        "recommendation": "Review to ensure that a TLS protocol agility is maintained.",
        "applies_to": [
        ],
        "tags": [
            "Cryptography.Protocol.TLS.Hard-Coded"
        ],
        "severity": "manual-review",
        "_comment": "",
        "rule_info": "DS440000.md",
        "patterns": [
            {
                "pattern": "\\b(SSL|D?TLS) ?v?[0123_\\.]*",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "modifiers" : ["i"],
                "_comment": "Generic reference to a SSL/TLS version"
            }
        ]
    },
    {
        "name": "OpenSSL: Hard-coded SSL/TLS Protocol",
        "id": "DS440010",
        "description": "OpenSSL: Hard-coded SSL/TLS Protocol",
        "recommendation": "",
        "overrides": [
            "DS440000"
        ],
        "applies_to": [
        ],
        "tags": [
            "Cryptography.Protocol.TLS.Hard-Coded"
        ],
        "severity": "manual-review",
        "_comment": "Applies to all languages since many just wrap OpenSSL constructs.",
        "rule_info": "DS440000.md",
        "patterns": [
            {
                "pattern": "SSLv2?3_method|D?TLSv1_([123]_)?(client_|server_)?method",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "OpenSSL functions that implement specific protocol versions"
            },
            {
                "pattern": "DTLSv1_listen|SSL_stateless",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "OpenSSL functions that implicitly call specific protocol versions"
            },
            {
                "pattern": "SSL_(CTX_)?set_(min|max)_proto_version",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "OpenSSL functions that explictly set protocol versions"
            },
            {
                "pattern": "SSL_EXT_TLS_ONLY|SSL_EXT_DTLS_ONLY|SSL_EXT_TLS_IMPLEMENTATION_ONLY|SSL_EXT_SSL3_ALLOWED|SSL_EXT_TLS1_2_AND_BELOW_ONLY|SSL_EXT|TLS1_3_ONLY|SSL_EXT_TLS1_2_SERVER_HELLO|SSL_EXT_TLS1_3_SERVER_HELLO",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "OpenSSL extension / options"
            },
            {
                "pattern": "SSL_OP_(NO_(SSLv3|TLSv1|TLSv1_1|TLSv1_2|TLSv1_3|DTLSv1|DTLSv1_2))",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "OpenSSL extension / options"
            },
            {
                "pattern": "(TLS_)?(AES|DH|DHE|ADH|CAMELLIA|EDH|EXP|DES|IDEA|RC4|NULL|GOST|EXP|ECDH|ECDHE|AECDH|PSK)[A-Z0-9\\-_]+-?(SHA|MD|GOST)[A-Z0-9\\-]*",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "OpenSSL cipher suite"
            }
        ]

        
    },
    {
        "name": "Generic: Hard-coded SSL/TLS Protocol",
        "id": "DS440015",
        "description": "Generic: Hard-coded SSL/TLS Protocol",
        "recommendation": "Review to ensure that a TLS protocol agility is maintained.",
        "overrides": [
            "DS440000"
        ],        
        "applies_to": [
        ],
        "tags": [
            "Cryptography.Protocol.TLS.Hard-Coded"
        ],
        "severity": "manual-review",
        "_comment": "",
        "rule_info": "DS440000.md",
        "patterns": [
            {
                "pattern": "--secure-protocol=",
                "type": "string",
                "scopes": [
                    "code"
                ],
                "_comment": "wget"
            },
            {
                "pattern": "--(sslv2|sslv3|tlsv1|tlsv11|tlsv1\\.1|tlsv1\\.2)",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "curl"
            },
            {
                "pattern": "ssl_protocols\\s+[^;]+;",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "Nginx"
            },
            {
                "pattern": "SSLProtocol\\s.+",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "Apache"
            },
            {
                "pattern": "sslEnabledProtocols\\s*=",
                "type": "regex",
                "scopes": [
                    "code"
                ],
                "_comment": "Generic"
            }
        ]
    }
]